(function(){let b=null;const j=n=>{let t,l,o,s;const h=()=>{console.log("previousEventHandler",b),b&&(console.log("removed PreviousEventHandler"),window.removeEventListener("message",b,!1))},d=p=>{t&&p.origin!==t||(o?o(p.data):s&&s["on"+p.data.eventName]&&typeof s["on"+p.data.eventName]=="function"&&s["on"+p.data.eventName](p.data.payload))},u=(p,E)=>{l==null||l.postMessage({eventName:p,payload:E},"*")},f=()=>{h()};return l=(n==null?void 0:n.target)||(window==null?void 0:window.parent),t=n==null?void 0:n.origin,o=n==null?void 0:n.handler,s=n==null?void 0:n.callbacks,h(),window.addEventListener("message",d,!1),b=d,{destroyMessenger:f,sendMessage:u}},z=({dialogId:n,title:t,body:l,buttons:o})=>{const s=document.createElement("div");s.id=n;let h=`<div style="font-size: 16px; font-weight: 600; color: rgb(54, 65, 82); padding-bottom: 4px; border-width: 0px; border-bottom-width: 1px; border-style: solid; border-color: rgb(226, 232, 240)">${t}</div>`,d=o.map(f=>`<button id="${f.id}" style="${f.style}">${f.label}</button>`).join(""),u=`
    <div style="position: fixed; left: 0; top: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; z-index: 1000000; background-color: rgba(0, 0, 0, 0.2);" >
      <div style="background-color: white;  border-radius: 4px; max-width: 360px; max-height: 75%; padding: 16px; display: flex; flex-direction: column; gap: 16px;">
        <div style="display: flex; flex-direction: column; gap: 12px;">
          ${t&&h||""}
          ${l||""}
        </div>
        <div style="display: flex; gap: 8px; justify-content: flex-end;">
          ${d}
        </div>
      </div>
    </div>
  `;return s.innerHTML=u,document.body.appendChild(s),o.forEach(f=>{var p;(p=document.getElementById(f.id))==null||p.addEventListener("click",f.onClick)}),s},H=n=>{n==null||n.remove()},C="cursor: pointer; background-color: rgb(38, 83, 107); border-style: none; border-radius: 4px; font-size: 12px; font-weight: 500; color: white; padding: 8px",S="cursor: pointer; background-color: white; border: 1px solid rgb(226, 232, 240); border-radius: 4px; font-size: 12px; font-weight: 500; color: rgb(54, 65, 82); padding: 8px",L={dialogId:"dialog-popup-info",body:'<div style="font-size: 14px; font-weight: 600;">You will be prompted to proceed with payment in a secure popup, Please proceed to pay.</div>',buttons:[{id:"dialog-primary-btn",label:"Proceed to Pay",style:C}]},P={dialogId:"dialog-popup-blocked",title:"A popup is blocked by your browser.",body:`<div style="font-size: 14px; font-weight: 400; color: rgb(54, 65, 82);">
        Please allow <span style="font-weight: 600;">Pop-ups and redirects</span>  in your browser settings.
        </div>
        <div style="color: rgb(240, 82, 82); font-size: 14px; font-weight: 600; line-height: 21px;">
        Once you have enabled the browser popup settings, please proceed by clicking on the 'Pay Now' button.
        </div>`,buttons:[{id:"dialog-cancel-btn",label:"Cancel",style:S},{id:"dialog-primary-btn",label:"Pay Now",style:C}]},W="2.0";(()=>{let n="tz-checkout",t=null,l=null,o=null,s=null,h=null,d=null,u=null,f=0,p=!1;console.log("new github repo code");const E=e=>{var a,i;!(e!=null&&e.eventName)||(e.eventName[0]==="_"&&typeof g[e.eventName]=="function"&&g[e.eventName](e),e.eventName[0]!=="_"&&g["on"+e.eventName]&&typeof g["on"+e.eventName]=="function"&&g["on"+e.eventName](e),e.eventName[0]!=="_"&&((a=t==null?void 0:t.callbacks)==null?void 0:a["on"+e.eventName])&&typeof((i=t==null?void 0:t.callbacks)==null?void 0:i["on"+e.eventName])=="function"&&t.callbacks["on"+e.eventName](e))},B=()=>{var i;n=((i=t==null?void 0:t.config)==null?void 0:i.domTarget)||"tz-checkout";const e=document.getElementById(n);if(!e)return null;e.innerHTML="",Object.assign(e.style,{display:"none",justifyContent:"center",alignItems:"center",padding:"var(--container_padding)",minHeight:"var(--container_minHeight)",maxHeight:"var(--container_maxHeight)",minWidth:"var(--container_minWidth)",maxWidth:"var(--container_maxWidth)",width:"min(100%,var(--container_maxWidth))",background:"var(--container_background)",backdropFilter:"var(--container_backdrop)",zIndex:"var(--container_zIndex)"});const a=document.createElement("iframe");return a.setAttribute("id","tz-iframe"),a.setAttribute("allow","clipboard-write *"),a.style.width="clamp(var(--container-iframe_minWidth),100%,var(--container-iframe_maxWidth))",a.style.height="clamp(var(--container-iframe_minHeight),100%,var(--container-iframe_maxHeight))",a.style.minHeight="var(--container-iframe_minHeight)",a.style.maxHeight="var(--container-iframe_maxHeight)",a.style.minWidth="var(--container-iframe_minWidth)",a.style.maxWidth="var(--container-iframe_maxWidth)",a.style.border="none",a.style.borderRadius="var(--container-iframe_borderRadius)",a.style.boxShadow="var(--container-iframe_boxshadow)",a.style.background="var(--container-iframe_background)",e.appendChild(a),window.addEventListener("beforeunload",()=>{d!=null&&d.closed||d==null||d.close()}),a},y=()=>{const e=document.getElementById(n);e.innerHTML="",e.style={},l=null},R=()=>{y(),s==null||s(),o=null,s=null,t=null,p=!1},O=e=>{if(console.timeEnd("preload-delay"),R(),e&&(t=e),l=B(),!l)return;const{sendMessage:a,destroyMessenger:i}=j({sdkVersion:W,origin:"https://checkout.tazapay.com",target:l.contentWindow,handler:E});return o=a,s=i,l.setAttribute("src","https://checkout.tazapay.com"+(t!=null&&t.payment?"/checkout":"")),console.time("preload-iframe"),!0},N=()=>{var a,i,c,r,m,x,_,w,k,v,D;let e={theme:t.theme,style:t.style,options:{sdkVersion:W,...t.config,_platform:(i=(a=t.config)==null?void 0:a._platform)!=null?i:"native",_escrowToken:(r=(c=t.config)==null?void 0:c._escrowToken)!=null?r:!1,_shopifyToken:(x=(m=t.config)==null?void 0:m._shopifyToken)!=null?x:null,parentOrigin:(w=(_=t.config)==null?void 0:_.origins)!=null?w:window.location.origin,popup:(v=(k=t.config)==null?void 0:k.popup)!=null?v:!1,redirectionTarget:$((D=t.config)==null?void 0:D.redirectionTarget)}};t.clientToken&&(e.clientToken=t.clientToken),t.payment&&(e.payment=t.payment),o==null||o("Init",e)},$=e=>["self","new_window","modal"].includes(e)?e:"self",A=()=>{var i,c;const e=document.getElementById(n);t.style||(t.style={}),(i=t.config)!=null&&i.popup&&Object.assign(e.style,{position:"fixed",top:0,left:0,height:"100vh",width:"100vw",overflow:"scroll","flex-direction":"column"});const a={container_zIndex:"1",container_padding:"1rem",container_minWidth:"0%",container_maxWidth:"750px",container_minHeight:"300px",container_maxHeight:"99999px","container-iframe_minWidth":"100%","container-iframe_maxWidth":"750px","container-iframe_minHeight":"300px","container-iframe_maxHeight":"99999px",container_background:"transparent","container-iframe_background":"transparent",container_backdrop:"","container-iframe_borderRadius":"4px","container-iframe_boxshadow":"0px 10px 15px rgba(226, 232, 240, 0.32), 0px 4px 6px rgba(226, 232, 240, 0.5)",modal_padding:"0rem",modal_zIndex:"9999",modal_minWidth:"0%",modal_maxWidth:"100%",modal_minHeight:"300px",modal_maxHeight:"100vh",modal_background:"rgb(0 0 0 / 0.3)",modal_backdrop:"blur(1px)","modal-iframe_minWidth":"0%","modal-iframe_maxWidth":"680px","modal-iframe_minHeight":"300px","modal-iframe_maxHeight":"100%","modal-iframe_background":"white","modal-iframe_borderRadius":"4px","modal-iframe_boxshadow":"0px 10px 15px rgba(226, 232, 240, 0.32), 0px 4px 6px rgba(226, 232, 240, 0.5)"};t.payment&&(l.style.height="45px",Object.assign(a,{container_minHeight:"10px",container_background:"white",container_padding:"0rem","container-iframe_minHeight":"10px","container-iframe_boxshadow":"","container-iframe_background":"transparent","container-iframe-loading_background":"transparent"})),(c=t.config)!=null&&c.popup&&Object.assign(a,{container_zIndex:"9999",container_padding:"0rem",container_background:"rgb(0 0 0 / 0.3)",container_backdrop:"blur(1px)",container_minWidth:"100vw",container_maxWidth:"100vw","container-iframe_borderRadius":"4px","container-iframe_maxHeight":"700px","container-iframe_minWidth":"0%","container-iframe_maxWidth":"550px","container-iframe_background":"white"}),setTimeout(()=>{let r=document.documentElement.style;Object.keys(a).forEach(m=>{r.setProperty("--"+m,a[m])}),e.style.display="flex",t.style&&Object.keys(t.style).filter(m=>m.includes("container")).forEach(m=>{r.setProperty("--"+m,t.style[m])})},0)},F=e=>{var r;let a=!l||!document.body.contains(l),i=((r=e==null?void 0:e.config)==null?void 0:r.domTarget)!==n,c=JSON.stringify(t)===JSON.stringify(e);if((a||i||c)&&O(e),!!l)return t||(t=e),A(),p&&N(),!0},V=e=>{const a=document.getElementById(n);a&&e&&(Object.keys(e).filter(i=>i.includes("container")).forEach(i=>{a.style.setProperty("--"+i,e[i])}),o==null||o("Dispatch",{method:"updateStyle",payload:{style:e}}))},J=e=>{let a=l&&document.body.contains(l);if(!(!l||!t)&&a&&p){if(e.clientToken)t.clientToken=e.clientToken;else if(!t.clientToken)return;let i={clientToken:t.clientToken,billingDetails:e.billingDetails};return o==null||o("InvokePayment",i),!0}},K=e=>{o==null||o("ValidatePayment",e)},Y=({url:e})=>{const a="tz-modal-container";let i=document.getElementById(a);i?i.innerHTML="":(i=document.createElement("div"),i.setAttribute("id",a)),Object.assign(i.style,{position:"fixed",top:0,left:0,display:"flex","flex-direction":"column",justifyContent:"center",alignItems:"center",padding:"var(--modal_padding)",height:"100vh",width:"100vw",minHeight:"var(--modal_minHeight)",maxHeight:"var(--modal_maxHeight)",minWidth:"var(--modal_minWidth)",maxWidth:"var(--modal_maxWidth)",background:"var(--modal_background)",backdropFilter:"var(--modal_backdrop)",zIndex:"var(--modal_zIndex)"});let c=document.documentElement.style;t.style&&Object.keys(t.style).filter(m=>m.includes("modal")).forEach(m=>{c.setProperty("--"+m,t.style[m])});const r=document.createElement("iframe");return r.setAttribute("id","tz-iframe"),r.setAttribute("src",e),r.style.width="clamp(var(--modal-iframe_minWidth),100%,var(--modal-iframe_maxWidth))",r.style.height="clamp(var(--modal-iframe_minHeight),95%,var(--modal-iframe_maxHeight))",r.style.minHeight="var(--modal-iframe_minHeight)",r.style.maxHeight="var(--modal-iframe_maxHeight)",r.style.minWidth="var(--modal-iframe_minWidth)",r.style.maxWidth="var(--modal-iframe_maxWidth)",r.style.border="none",r.style.borderRadius="var(--modal-iframe_borderRadius)",r.style.boxShadow="var(--modal-iframe_boxshadow)",r.style.background="var(--modal-iframe_background)",i.appendChild(r),i},q=e=>{u&&document.contains(u)&&u.remove(),e!=null&&e.silent||o==null||o("Dispatch",{method:"modalDestroyed",payload:e})},T=(e,a=!1,i=!1)=>{a?(H(h),i?(P.buttons[0].onClick=()=>g.onCloseWindow(e),P.buttons[1].onClick=()=>I(e),h=z(P)):(L.buttons[0].onClick=()=>I(e),h=z(L))):I(e,!0)},I=(e,a=!1)=>{let i=e.payload.width||700,c=e.payload.height||700;const r=(w,k,v)=>Math.min(Math.max(w,k),v);i=r(i,340,screen.width),c=r(c,480,screen.height);let m=(screen.width-i)/2,x=(screen.height-c)/2,_=`width=${i},height=${c},left=${m},top=${x}`;d=window.open(e.payload.url,"popUpWindow",_),!d||d.closed||typeof d.closed>"u"?(o==null||o("Dispatch",{method:"popupBlocked",payload:e.payload}),t&&t.callbacks&&t.callbacks.onPopupBlocked&&t.callbacks.onPopupBlocked({url:e.payload.url}),a?T(e,!0,!1):T(e,!0,!0)):(H(h),f=setInterval(()=>{d.closed&&(clearInterval(f),o==null||o("Dispatch",{method:"popupClosed"}))},1e3),o==null||o("Dispatch",{method:"popupOpened"}),e.payload.html&&d.document.write(e.payload.html))},g={onLoad:()=>{console.timeEnd("preload-iframe"),p=!0,t&&N()},onPaymentMethodSelected:()=>{},onPaymentAttempted:()=>{},onPaymentMethodReset:()=>{},onLoadParentLocation:e=>{e.payload.html?window.document.write(e.payload.html):window.top.location.href=e.payload.url},onLoadModalLocation:e=>{u=Y(e.payload),document.body.appendChild(u),o==null||o("Dispatch",{method:"modalCreated",payload:e.payload})},onCloseModal:e=>{q(e.payload)},onLoadPopupLocation:e=>{T(e)},onCloseWindow:e=>{var a;f&&clearInterval(f),window.focus(),d==null||d.close(),H(h),(a=e.payload)!=null&&a.silent||o==null||o("Dispatch",{method:"popupClosed"})},onPaymentCancel:e=>{var a;(a=t.config)!=null&&a.popup&&y(),e.payload.url&&onLoadParentLocation(e)},onPaymentReport:e=>{var a;(a=t.config)!=null&&a.clearOnComplete&&y(),e.payload.url&&onLoadParentLocation(e)},onPaymentSuccess:e=>{var a;(a=t.config)!=null&&a.clearOnComplete&&y(),e.payload.url&&onLoadParentLocation(e)},onPaymentFail:e=>{var a;(a=t.config)!=null&&a.clearOnComplete&&y(),e.payload.url&&onLoadParentLocation(e)},onResizeIframe:e=>{l&&(l.style.height=e.payload.height+"px")},_Dispatch:e=>{const{method:a,payload:i}=e.payload;switch(a){case"openChildWindow":window.open(i.url,i.target||"_blank",i.windowFeatures);break;case"download":const c=document.createElement("a");c.href=i.href,c.setAttribute("download",`${i.download}`),document.body.appendChild(c),c.click(),setTimeout(()=>{document.body.removeChild(c)},5e3);break}}};window.tazapay||(Object.defineProperty(window,"tazapay",{enumerable:!1,configurable:!1,writable:!1,value:Object.freeze({preload:O,checkout:F,confirmCardPayment:J,validate:K,updateStyle:V,getVersion:()=>W})}),window.dispatchEvent(new Event("tzInit"))),console.log("Tazapay SDK ready"),console.time("preload-delay")})()})();
