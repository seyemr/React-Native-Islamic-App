(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2142,4634,8391],{21493:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[id]",function(){return o(63370)}])},26636:function(e,t,o){"use strict";o.d(t,{o:function(){return l}});var n=o(97458);const l=o(52983).forwardRef(((e,t)=>{let{children:o,contentWrapperCssClasses:l="flex-grow overflow-hidden",headerControl:r,headerWrapperCssClasses:s="bg-white h-16 flex items-center sm:px-6 px-2 border-b border-gray-100 flex-shrink-0",id:a}=e;return(0,n.jsxs)("div",{id:a,ref:t,"data-onboarding-watch":"create_menu_new_button",className:"flex overflow-y-auto absolute inset-0 flex-col w-full",children:[r&&(0,n.jsx)("div",{className:s,children:r}),(0,n.jsx)("div",{className:l,children:o})]})}));l.displayName="PageScaffold"},41767:function(e,t,o){"use strict";o.d(t,{O:function(){return r}});var n=o(52983),l=o(23108);const r=e=>{let{scopes:t}=e;const o=(0,n.useCallback)((()=>Boolean(null==t?void 0:t.includes(l.l.DOWNLOAD))),[t]);return{hasUpdateAccess:(0,n.useCallback)((()=>Boolean(null==t?void 0:t.includes(l.l.FULL_ACCESS))),[t]),hasDownloadAccess:o}}},78652:function(e,t,o){"use strict";var n=o(52983);t.Z=e=>{let{onPress:t,onRelease:o,dependencies:l=[],takesPrecedence:r}=e;(0,n.useEffect)((()=>{const e=e=>{const o=document.activeElement;o&&o.isContentEditable||o&&"button"===o.tagName.toLowerCase()&&!r||"Shift"===e.key&&(e.preventDefault(),t())},n=e=>{const t=document.activeElement;t&&t.isContentEditable||t&&"button"===t.tagName.toLowerCase()&&!r||"Shift"===e.key&&(e.preventDefault(),o())};return window.addEventListener("keydown",e),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keydown",n)}}),l)}},63370:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return U}});var n=o(97458),l=o(96734),r=o(88360),s=o(34723),a=o(69238),i=o(34038),c=o.n(i),d=o(54542),u=o.n(d),f=o(52983),v=o(75800),p=o(80794),h=o(26636),w=o(8824),m=o(2242),g=o(186),C=o(41767),E=o(78652),j=o(21330),k=o(49939),y=o(24148),S=o(8391),x=o(34806),b=o(5775),I=o(46382),A=o(68527),F=o(70705),D=o(46989),R=o(49146),N=o(78586),L=o(92653),P=o(83849),_=o.n(P);const T=c()((async()=>Promise.all([o.e(2064),o.e(2418),o.e(895)]).then(o.bind(o,22210))),{loadableGenerated:{webpack:()=>[22210]},ssr:!1}),O=c()((async()=>Promise.all([o.e(9117),o.e(6337),o.e(1275),o.e(6537)]).then(o.bind(o,35339))),{loadableGenerated:{webpack:()=>[35339]},ssr:!1}),M=c()((async()=>o.e(8877).then(o.bind(o,68877))),{loadableGenerated:{webpack:()=>[68877]},ssr:!1});function U(){var e,t,o,i,c,d,P,U,W,B,G,q,J;const V=(0,a.useRouter)(),{user:Z}=(0,m.a)(),{from:Q,id:Y,sort:H,status:K,type:X}=V.query,z=(0,w.p)(),$=(0,v.useSetRecoilState)(b.qx),[ee,te]=(0,f.useState)(!1),oe=(0,v.useSetRecoilState)(I.QJ),[ne,le]=(0,f.useState)([]),re=(0,v.useSetRecoilState)(S.Y),se=ne.length>0,ae=(0,l.SS)(s.AD.FILE_UPLOAD_LIMIT),[ie,ce]=(0,f.useState)(null),[de,ue]=(0,f.useState)(!1),[fe,ve]=(0,f.useState)(null),[pe,he]=(0,f.useState)(null),[we,me]=(0,f.useState)(!1),{downloadAllInFolder:ge,downloadAllInProject:Ce,downloadSelection:Ee,isZipDownloadInProgress:je}=(0,L.p)();(0,E.Z)({onPress:()=>{ue(!0)},onRelease:()=>{ue(!1)}});const ke=(0,p.m8)(),[ye]=(0,p.aM)({query:y.FE,variables:{id:Y},pause:!Y}),Se=(null===(e=ye.data)||void 0===e?void 0:e.project)||null,xe=(0,f.useMemo)((()=>"folders"!==X&&(null==Se?void 0:Se.isSystem)&&"Drafts"===(null==Se?void 0:Se.title)),[Se,X]),[be]=(0,p.aM)({query:y.f3,variables:{id:Y,orderBy:H||JSON.stringify({isFolder:"DESC",updatedAt:"DESC"}),status:K,type:X,first:24,...xe&&{createdByUserId:null==Z?void 0:Z.id}},pause:!Y||!(null==Z?void 0:Z.id)||!Se}),Ie=(0,k.hp)(null===(o=ye.data)||void 0===o||null===(t=o.project)||void 0===t?void 0:t.workspaceId),Ae=(0,f.useMemo)((()=>(0,R.fK)(Ie)),[Ie]),Fe=ae.on&&Ae===A.Q.FREE,De=null===(c=be.data)||void 0===c||null===(i=c.projectFiles)||void 0===i?void 0:i.edges.map((e=>e.node));(0,f.useEffect)((()=>{ye.fetching||(ye.error?(0,D.w)(ye.error):ye.data&&ye.data.project&&(oe({name:ye.data.project.title,isPrivate:Boolean(ye.data.project.isPrivate),isSystem:ye.data.project.isSystem,projectTitle:ye.data.project.title,type:"project",workspaceId:ye.data.project.workspaceId,projectId:ye.data.project.id}),(0,r.Z9)(new r.RG({projectId:ye.data.project.id,projectName:ye.data.project.title,workspaceId:ye.data.project.workspaceId,url:window.location.href})),$(!1)))}),[ye,V,$,oe]);const Re=(null===(d=be.data)||void 0===d?void 0:d.projectFiles.pageInfo.endCursor)||null,Ne=(null===(P=be.data)||void 0===P?void 0:P.projectFiles.pageInfo.hasNextPage)||!1,Le=(0,f.useCallback)((e=>{ve(N.RT.LOADED);const t=ne,o=t.map((e=>e.id)).indexOf(e);if(De){const n=De.find((t=>t.id===e));if(!n)return;const l=De.indexOf(n);if(de)if(null===ie)t.push(n);else{const e=(0,N.Jm)(ie,l,De);o>-1?(0,N.wh)(t,e):(0,N.AW)(t,e)}else o>-1?t.splice(o,1):t.push(n);ce(l)}0===t.length&&ve(null),le([...t]),re(t.length)}),[ne,De,re,ie,de]),Pe=(0,f.useCallback)((()=>{ve(null),re(0),le([]),ce(null),me(!1)}),[re]);(0,f.useEffect)((()=>{je&&Pe()}),[je,Pe]);const _e=(0,f.useMemo)((()=>be.fetching||ye.fetching),[be.fetching,ye.fetching]),Te=(0,f.useCallback)((()=>{if(Se)try{var e;Ee({project:Se,downloadAssetCount:fe===N.RT.EVERYTHING?(null===(e=be.data)||void 0===e?void 0:e.projectFiles.totalCount)||0:ne.length,entries:fe===N.RT.EVERYTHING?[{id:Y,type:"PROJECT"}]:ne.map((e=>({id:e.id,type:(0,F.qR)(e)?"FOLDER":"FILE"})))})}catch(e){null==z||z.pushError(e.message)}}),[Ee,Se,null===(U=be.data)||void 0===U?void 0:U.projectFiles.totalCount,ne,fe,z,Y]),Oe=(0,f.useCallback)((()=>{if(Se)try{var e;Ce({project:Se,downloadAssetCount:(null===(e=be.data)||void 0===e?void 0:e.projectFiles.totalCount)||0})}catch(e){null==z||z.pushError(e.message)}}),[Ce,Se,null===(W=be.data)||void 0===W?void 0:W.projectFiles.totalCount,z]),Me=(0,f.useCallback)(((e,t)=>{if(Se)try{ge({downloadAssetCount:1,folderId:e,folderName:t,project:Se})}catch(e){null==z||z.pushError(e.message)}}),[ge,Se,z]),[Ue,We]=(0,g._)("project-view","grid"),Be=(0,f.useCallback)((()=>{We("grid"===Ue?"list":"grid"),(0,r.Z9)(new r.rR({projectId:Y,userId:null==Z?void 0:Z.id,view:"grid"===Ue?"list":"grid"}))}),[Ue,We,Y,Z]),Ge=(0,v.useRecoilValue)(x.h),qe=(0,f.useCallback)((()=>{Pe(),null==z||z.pushSuccess("".concat(ne.length>1?"Assets were":"Asset was"," successfully transferred to ").concat(null==Ge?void 0:Ge.name,"."))}),[Pe,ne.length,null==Ge?void 0:Ge.name,z]),Je=(0,f.useCallback)((e=>{var t,o;const n=ne,l=null===(o=be.data)||void 0===o||null===(t=o.projectFiles)||void 0===t?void 0:t.edges.map((e=>e.node));e?((0,N.AW)(n,l||[]),re(n.length),ve(N.RT.LOADED),me(!0)):((0,N.wh)(n,l||[]),re(n.length),ve(null),me(!1)),le([...n])}),[null===(G=be.data)||void 0===G||null===(B=G.projectFiles)||void 0===B?void 0:B.edges,ne,re]),Ve=(0,f.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;if(!De||0===(null==De?void 0:De.length))return;const o=e&&be.data?(null===(t=be.data)||void 0===t?void 0:t.projectFiles.totalCount)-(null==De?void 0:De.length):24,n=Fe?Math.min(12,Math.abs(ae.value-(null==De?void 0:De.length))):o;try{te(!0),await ke.query(y.f3,{id:Y,status:K,type:X,orderBy:H||JSON.stringify({isFolder:"DESC",updatedAt:"DESC"}),after:Re,first:n,...xe&&{createdByUserId:null==Z?void 0:Z.id}}).toPromise()}finally{te(!1)}}),[De,be.data,Fe,ae.value,ke,Y,K,X,H,Re,xe,null==Z?void 0:Z.id]),Ze=(0,f.useCallback)((()=>{ye.data&&!ye.fetching&&!ee&&Ne&&Re&&Ve()}),[Re,Ve,ye.data,ye.fetching,Ne,ee]);(0,f.useEffect)((()=>{Pe()}),[V.asPath,Pe]);const Qe="https://creator.lottiefiles.com",Ye=(0,f.useCallback)(((e,t)=>{let o;const n="shared-with-me"===Q;if(((0,F.QR)(e)||(0,F.xK)(e))&&(o=e.fileObject.filename.split(".").pop()),"creator"===o)window.open("".concat(Qe,"?fileId=").concat(e.id,"&utm_medium=platform&utm_source=file-card"),"_blank");else{let o;o=(0,F.qR)(e)?"/folder/".concat(e.id):"/animation/".concat(e.id),H&&(o+="?sort=".concat(encodeURIComponent(H.toString()))),n&&(o+="".concat(H?"&":"?","from=shared-with-me")),t?window.open(o,"_blank"):V.push(o)}}),[Q,Qe,H,V]),He=(0,f.useCallback)((async()=>{if(De){const e=await ke.query(y.A0,{id:Y}).toPromise();e.data&&he(e.data.project.stats),le([...De])}ve(N.RT.EVERYTHING)}),[ke,Y,De]),Ke=ne.length&&(null==De?void 0:De.some((e=>-1===ne.findIndex((t=>t.id===e.id)))))||!1,{hasDownloadAccess:Xe,hasUpdateAccess:ze}=(0,C.O)({scopes:(null==Se?void 0:Se.projectPermissionScopes)||[]}),[$e,et]=(0,f.useState)(!1);return(0,f.useEffect)((()=>{xe&&(null==Z?void 0:Z.id)&&!$e&&((0,r.Z9)(new r.di({userId:Z.id})),et(!0))}),[xe,null==Z?void 0:Z.id,$e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u(),{children:(0,n.jsx)("title",{children:"Project - LottieFiles Platform"})}),(0,n.jsx)(j.s,{features:null==Se?void 0:Se.features,children:(0,n.jsx)(h.o,{headerWrapperCssClasses:_()("flex items-center px-6 flex-shrink-0 pt-3 pb-4"),contentWrapperCssClasses:"flex-grow p-6 pt-0",headerControl:(0,n.jsx)(T,{selectedCount:ne.length,loadedCount:(null==De?void 0:De.length)||0,showFilters:0!==(null==De?void 0:De.length)||(Boolean(K)||Boolean(X)),totalCount:(null===(q=be.data)||void 0===q?void 0:q.projectFiles.totalCount)||0,onSelectAll:Je,selectionIsIndeterminate:Ke,isSelectionMode:se,toggleProjectView:Be,projectView:Ue,project:Se,fromSharedWithMe:"shared-with-me"===Q,selectionType:fe,onSelectEverything:He,clearSelection:Pe,showSelectionBanner:we,onDownloadAllClick:Oe,showSelectAll:Xe()||ze()}),children:(0,n.jsx)("div",{className:"space-y-3 h-full",children:Se&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M,{files:De,hasNextPage:Ne,isFetchingFiles:_e,isFetchingMore:ee,isSelectionMode:se,onFolderDownloadAllClick:Me,onItemClick:Ye,onLoadMore:Ze,onSelectionChange:Le,project:Se,selectedFiles:ne,status:K,type:X,view:Ue}),se?(0,n.jsx)(O,{canDelete:ze(),canDownload:Xe(),canMove:ze(),canUpdateStatus:ze(),canAddToCollection:ze(),type:"project",resourceId:Se.id,workspaceId:Se.workspace.id,selectedAnimations:ne,isPrivate:Se.isPrivate,clear:Pe,onDownload:Te,onTransferComplete:qe,totalCount:(null===(J=be.data)||void 0===J?void 0:J.projectFiles.totalCount)||0,contentStats:pe,isEverythingSelected:fe===N.RT.EVERYTHING}):null]})})})})]})}},21330:function(e,t,o){"use strict";o.d(t,{s:function(){return a},w:function(){return i}});var n=o(97458),l=o(34723),r=o(52983);const s=r.createContext({features:[]}),a=e=>{let{children:t,features:o}=e;return(0,n.jsx)(s.Provider,{value:{features:o},children:t})},i=()=>{const{features:e}=r.useContext(s);return e?new l.UZ(e):new l.UZ([])}},8391:function(e,t,o){"use strict";o.d(t,{Y:function(){return n}});const n=(0,o(75800).atom)({key:"selectedAnimationsCount",default:0})},46577:function(e,t,o){"use strict";o.d(t,{h:function(){return l}});var n=o(75800);const l=(0,n.atom)({key:"transferSelectionAtom",default:null});(0,n.atom)({key:"createNewFolder",default:!1})},34806:function(e,t,o){"use strict";o.d(t,{h:function(){return n.h}});var n=o(46577)},23108:function(e,t,o){"use strict";var n;function l(e){return"object"==typeof e&&null!==e&&"folders"in e}o.d(t,{k:function(){return l},l:function(){return n}}),function(e){e.DOWNLOAD="download",e.FULL_ACCESS="full_access",e.VIEW="view"}(n||(n={}))},46989:function(e,t,o){"use strict";o.d(t,{w:function(){return s}});var n=o(40707),l=o(6253);const r={"Access denied!":e=>{var t,o,l,r;const s=null!==(r=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==r?r:"";var a;const i=null!==(a=null==e||null===(l=e.extensions)||void 0===l||null===(o=l.exception)||void 0===o?void 0:o.stacktrace)&&void 0!==a?a:[];throw console.log("Error code:",s),console.log("Stacktrace:",i),new n.J},"Database query failed":e=>{var t,o,l,r;const s=null!==(r=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==r?r:"";var a;const i=null!==(a=null==e||null===(l=e.extensions)||void 0===l||null===(o=l.exception)||void 0===o?void 0:o.stacktrace)&&void 0!==a?a:[];throw console.log("Error code:",s),console.log("Stacktrace:",i),new n.J},"File not found":e=>{var t,o,n,r;const s=null!==(r=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==r?r:"";var a;const i=null!==(a=null==e||null===(n=e.extensions)||void 0===n||null===(o=n.exception)||void 0===o?void 0:o.stacktrace)&&void 0!==a?a:[];throw console.log("Error code:",s),console.log("Stacktrace:",i),new l.T},Forbidden:e=>{var t,o,l,r;const s=null!==(r=null==e||null===(t=e.extensions)||void 0===t?void 0:t.code)&&void 0!==r?r:"";var a;const i=null!==(a=null==e||null===(l=e.extensions)||void 0===l||null===(o=l.exception)||void 0===o?void 0:o.stacktrace)&&void 0!==a?a:[];throw console.log("Error code:",s),console.log("Stacktrace:",i),new n.J}};function s(e){e.networkError?console.error("Network error:",e.networkError):e.graphQLErrors&&e.graphQLErrors.length>0?e.graphQLErrors.forEach((e=>{const t=e.message,o=Object.keys(r).find((e=>t.includes(e)));var n;o?null===(n=r[o])||void 0===n||n.call(r,e):console.error("GraphQL error:",e)})):console.error("Unknown error:",e)}},78586:function(e,t,o){"use strict";var n;function l(e,t,o){const n=Math.min(e,t),l=Math.max(e+1,t+1);return o.splice(n,l-n)}function r(e,t){t.forEach((t=>{const o=e.findIndex((e=>e.id===t.id));o>-1&&e.splice(o,1)}))}function s(e,t){t.forEach((t=>{-1===e.findIndex((e=>e.id===t.id))&&e.push(t)}))}o.d(t,{AW:function(){return s},Jm:function(){return l},RT:function(){return n},wh:function(){return r}}),function(e){e.EVERYTHING="everything",e.LOADED="loaded"}(n||(n={}))}},function(e){e.O(0,[2888,9774,179],(function(){return t=21493,e(e.s=t);var t}));var t=e.O();_N_E=t}]);